/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/bcbp@6.0.2/dist/index.umd.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).bcbp={})}(this,(function(e){"use strict";const t=(e,t=!1)=>{const a=(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate())-Date.UTC(e.getUTCFullYear(),0,0))/864e5;let i="";return t&&(i=e.getUTCFullYear().toString().slice(-1)),`${i}${a.toString().padStart(3,"0")}`},a=(e,t,a)=>{const i=a??new Date(Date.now()).getUTCFullYear();let r=i.toString(),n=e;t&&(r=r.toString().slice(0,-1)+n[0],n=n.substring(1),parseInt(r)-i>2&&(r=(parseInt(r)-10).toString()));const d=new Date(Date.UTC(parseInt(r),0));return new Date(d.setUTCDate(parseInt(n)))};class i{output=[];fieldSizes=[];addField(e,a,i=!1){let r="";r=void 0===e?"":"number"==typeof e?e.toString():e instanceof Date?t(e,i):"boolean"==typeof e?e?"Y":"N":e;let n=r.length;if(void 0!==a)if(n>a)r=r.substring(0,a);else if(n<a)for(let e=0;e<a-n;e++)r+=" ";this.output.push(r),this.fieldSizes.push({size:a??r.length,isDefined:void 0!==e})}addSection(e){const t=e.toString();let a=!1,i=0;for(let t of e.fieldSizes.reverse())!a&&t.isDefined&&(a=!0),a&&(i+=t.size);this.addField(i.toString(16).padStart(2,"0").toUpperCase(),2),this.addField(t,i)}toString(){return this.output.join("")}}class r{currentIndex=0;constructor(e){this.barcodeString=e}getNextField(e){if(void 0===this.barcodeString)return;const t=this.barcodeString.length;if(this.currentIndex>=t)return;let a;const i=this.currentIndex;a=void 0===e?this.barcodeString.substring(i):this.barcodeString.substring(i,i+e),this.currentIndex+=e??t;const r=a.trimEnd();return""!==r?r:void 0}getNextString(e){return this.getNextField(e)}getNextNumber(e){const t=this.getNextField(e);if(void 0!==t)return parseInt(t)}getNextDate(e,t,i){const r=this.getNextField(e);if(void 0!==r)return a(r,t,i)}getNextBoolean(){const e=this.getNextField(1);if(void 0!==e)return"Y"===e}getNextSectionSize(){return e=this.getNextField(2)??"00",parseInt(e,16);var e}getRemainingString(){return this.getNextField()}}e.decode=(e,i)=>{const n={},d=new r(e);n.data={},n.meta={},n.meta.formatCode=d.getNextString(1),n.meta.numberOfLegs=d.getNextNumber(1)??0,n.data.passengerName=d.getNextString(20),n.meta.electronicTicketIndicator=d.getNextString(1),n.data.legs=[];let g=!1;for(let e=0;e<n.meta.numberOfLegs;e++){const e={};e.operatingCarrierPNR=d.getNextString(7),e.departureAirport=d.getNextString(3),e.arrivalAirport=d.getNextString(3),e.operatingCarrierDesignator=d.getNextString(3),e.flightNumber=d.getNextString(5),e.flightDate=d.getNextDate(3,!1,i),e.compartmentCode=d.getNextString(1),e.seatNumber=d.getNextString(4),e.checkInSequenceNumber=d.getNextString(5),e.passengerStatus=d.getNextString(1);const t=d.getNextSectionSize(),a=new r(d.getNextString(t));if(!g){n.meta.versionNumberIndicator=a.getNextString(1),n.meta.versionNumber=a.getNextNumber(1);const e=a.getNextSectionSize(),t=new r(a.getNextString(e));n.data.passengerDescription=t.getNextString(1),n.data.checkInSource=t.getNextString(1),n.data.boardingPassIssuanceSource=t.getNextString(1),n.data.issuanceDate=t.getNextDate(4,!0,i),n.data.documentType=t.getNextString(1),n.data.boardingPassIssuerDesignator=t.getNextString(3),n.data.baggageTagNumber=t.getNextString(13),n.data.firstBaggageTagNumber=t.getNextString(13),n.data.secondBaggageTagNumber=t.getNextString(13),g=!0}const o=a.getNextSectionSize(),s=new r(a.getNextString(o));e.airlineNumericCode=s.getNextString(3),e.serialNumber=s.getNextString(10),e.selecteeIndicator=s.getNextString(1),e.internationalDocumentationVerification=s.getNextString(1),e.marketingCarrierDesignator=s.getNextString(3),e.frequentFlyerAirlineDesignator=s.getNextString(3),e.frequentFlyerNumber=s.getNextString(16),e.idIndicator=s.getNextString(1),e.freeBaggageAllowance=s.getNextString(3),e.fastTrack=s.getNextBoolean(),e.airlineInfo=a.getRemainingString(),n.data.legs.push(e)}n.meta.securityDataIndicator=d.getNextString(1),n.data.securityDataType=d.getNextString(1);const o=d.getNextSectionSize(),s=new r(d.getNextString(o));if(n.data.securityData=s.getNextString(100),void 0!==n.data.issuanceDate){const e=n.data.issuanceDate.getFullYear();for(let i of n.data.legs)if(void 0!==i.flightDate){const r=t(i.flightDate);i.flightDate=a(r,!1,e),i.flightDate<n.data.issuanceDate&&(i.flightDate=a(r,!1,e+1))}}return n},e.encode=e=>{e.meta={formatCode:"M",numberOfLegs:e?.data?.legs?.length??0,electronicTicketIndicator:"E",versionNumberIndicator:">",versionNumber:6,securityDataIndicator:"^",...e.meta};const t=new i;if(void 0===e.data?.legs||0===e.data.legs.length)return"";t.addField(e.meta.formatCode,1),t.addField(e.meta.numberOfLegs,1),t.addField(e.data.passengerName,20),t.addField(e.meta.electronicTicketIndicator,1);let a=!1;for(let r of e.data.legs){t.addField(r.operatingCarrierPNR,7),t.addField(r.departureAirport,3),t.addField(r.arrivalAirport,3),t.addField(r.operatingCarrierDesignator,3),t.addField(r.flightNumber,5),t.addField(r.flightDate,3),t.addField(r.compartmentCode,1),t.addField(r.seatNumber,4),t.addField(r.checkInSequenceNumber,5),t.addField(r.passengerStatus,1);const n=new i;if(!a){n.addField(e.meta.versionNumberIndicator,1),n.addField(e.meta.versionNumber,1);const t=new i;t.addField(e.data.passengerDescription,1),t.addField(e.data.checkInSource,1),t.addField(e.data.boardingPassIssuanceSource,1),t.addField(e.data.issuanceDate,4,!0),t.addField(e.data.documentType,1),t.addField(e.data.boardingPassIssuerDesignator,3),t.addField(e.data.baggageTagNumber,13),t.addField(e.data.firstBaggageTagNumber,13),t.addField(e.data.secondBaggageTagNumber,13),n.addSection(t),a=!0}const d=new i;d.addField(r.airlineNumericCode,3),d.addField(r.serialNumber,10),d.addField(r.selecteeIndicator,1),d.addField(r.internationalDocumentationVerification,1),d.addField(r.marketingCarrierDesignator,3),d.addField(r.frequentFlyerAirlineDesignator,3),d.addField(r.frequentFlyerNumber,16),d.addField(r.idIndicator,1),d.addField(r.freeBaggageAllowance,3),d.addField(r.fastTrack,1),n.addSection(d),n.addField(r.airlineInfo),t.addSection(n)}if(void 0!==e.data.securityData){t.addField(e.meta.securityDataIndicator,1),t.addField(e.data.securityDataType??"1",1);const a=new i;a.addField(e.data.securityData,100),t.addSection(a)}return t.toString()}}));
//# sourceMappingURL=/sm/434ed1daee6dd20b71c9a7defff9568660d020ff2355a8f17b8b50edd5eec7d1.map